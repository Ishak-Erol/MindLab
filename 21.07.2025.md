# 🔄 Update: Wechsel von ST-Link-Tools zu OpenOCD

Die ST-Link-Software (V1) erwies sich in meinem Setup als **nicht zuverlässig genug**.  
Folgende Probleme traten auf:

## ❌ Probleme mit ST-Link (st-flash)

- **Flashen und Löschen** schlugen fehl:
  ```bash
  st-flash --connect-under-reset write build/BlinkingLights.bin 0x08000000
  st-flash erase

→ Verbindungsfehler (LIBUSB_ERROR_PIPE), kein Zugriff auf das Target.

    Lesen des Flash-Speichers funktionierte nicht:

    st-flash read testErase.bin 0x08000000 0x4000

    → Flashgröße = 0, Chip-ID = 0x000 → Target wurde nicht erkannt.

💡 Vermutete Ursache

    Die verwendete ST-Link-Hardware ist Version V1.

    Diese wird von st-flash nur eingeschränkt oder gar nicht unterstützt.

    Auch st-info gibt ungültige Werte zurück:

    flash: 0 (pagesize: 0)
    chipid: 0x000

✅ Lösung: Wechsel zu OpenOCD

Um zuverlässig flashen und debuggen zu können, wurde OpenOCD eingesetzt. Vorteile:

    Kompatibel mit ST-Link V1

    Zuverlässige Verbindung mit dem Target

    Direkte Steuerung via Telnet möglich

📋 Beispielhafte Telnet-Sitzung

telnet localhost 4444

reset halt
flash write_image /pfad/zur/BlinkingLights.bin 0x08000000
reset run

📤 Flash-Dump zum Überprüfen des Speichers

dump_image flash_dump.bin 0x08000000 0x20000

Analyse z. B. mit:

hexdump -C flash_dump.bin

🛠 Konfiguration für OpenOCD

source [find interface/stlink-v1.cfg]
transport select hla_swd
source [find target/stm32f1x.cfg]
reset_config srst_only

⚠️ Stelle sicher, dass der Pfad zur .bin-Datei korrekt und absolut ist, z. B.:

flash write_image /home/username/projekt/BlinkingLights.bin 0x0800000